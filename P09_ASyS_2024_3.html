<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Pr&aacute;ctica 9: Sistemas diferenciales y en diferencias</title>
<meta name="generator" content="MATLAB 23.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2024-06-17">
<meta name="DC.source" content="prac09.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>Pr&aacute;ctica 9: Sistemas diferenciales y en diferencias</h1>
<!--introduction-->
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Integrantes:</a>
</li>
<li>
<a href="#2">Introduccion</a>
</li>
<li>
<a href="#4">Objetivos</a>
</li>
<li>
<a href="#6">Porcedimiento</a>
</li>
</ul>
</div>
<h2 id="1">Integrantes:</h2>
<p>Decena Luna Emiliano Abdala</p>
<p>Morales Rodr&iacute;guez Francisco Jes&uacute;s</p>
<p>Soriano L&oacute;pez Aron</p>
<h2 id="2">Introduccion</h2>
<p>&iquest;Qu&eacute; es la transformada de Fourier y para que sirve? En pocas palabras la transformada de Fourier convierte una funci&oacute;n del tiempo, una variable continua, en una funci&oacute;n de frecuencia, revelando la frecuencia o las frecuencias que componen la se&ntilde;al original.</p>
<h2 id="4">Objetivos</h2>
<p>Generar un codigo en Matlab que sea capaz de resolver ecuaciones diferenciales utilizando la transformada de Fourier para tiempos continuos y discretos. Para que asu vez entregar un documento en HTML qeu cumpla los requerimientos ya establecidos en la descripcion de Teams.</p>
<h2 id="6">Porcedimiento</h2>
<p>main_script.m</p>
<pre class="codeinput">
<span class="comment">% Ejemplo de uso para la ecuaci&oacute;n diferencial especificada</span>
syms <span class="string">t</span>
a = [1 3 3];
b = [-1 1];
ciy = [1, 1];
xi = cos(2*t)*heaviside(t);
t0 = 10;
combined_solution_continuous(a, b, ciy, xi, t0)
<span class="comment">%</span>
</pre>
<p>Ejemplo de uso para el primer problema discreto</p>
<pre class="codeinput">syms <span class="string">n</span>
a = [2 1];
b = [2];
ciy = [3];
xi = heaviside(n);
n0 = 5;
z_transform_solution_1(a, b, ciy, xi, n0)
<span class="comment">%</span>
</pre>
<p>Ejemplo de uso para el segundo problema discreto</p>
<pre class="codeinput">syms <span class="string">n</span>
a2 = [2 -3 1];
b2 = [4 -3];
ciy2 = [0 1];
xi2 = (1/4)^n * heaviside(n);
n0_2 = 5;
z_transform_solution_2(a2, b2, ciy2, xi2, n0_2)
<span class="comment">%</span>
</pre>
<pre class="codeinput">
<span class="keyword">function</span> z_transform_solution_2(a, b, ciy, xi, n0)
    <span class="comment">% a: coeficientes de las traslaciones de la salida mayor a menor [a_n, ..., a_0]</span>
    <span class="comment">% b: coeficientes de las traslaciones de la entrada mayor a menor [b_m, ..., b_0]</span>
    <span class="comment">% ciy: condiciones iniciales de la salida de mayor a menor [y(n-1), y(0)]</span>
    <span class="comment">% xi: funci&oacute;n de entrada en t&eacute;rminos de la variable simb&oacute;lica n</span>
    <span class="comment">% n0: tiempo final para graficar la soluci&oacute;n y la entrada</span>

    close <span class="string">all</span>;
    tam = size(a);
    tami = size(b);
    syms <span class="string">y(n)</span> <span class="string">n</span> <span class="string">z</span> <span class="string">Y(z)</span> <span class="string">x(n)</span> <span class="string">X(z)</span> <span class="string">Yy</span>;
    syms <span class="string">edd</span> <span class="string">edi</span>;
    edd = 0;
    edi = 0;

    <span class="keyword">for</span> i = 1:tam(2)
       yd(i) = y(n+tam(2)-i);
       edd = edd + a(i)*ztrans(yd(i));
    <span class="keyword">end</span>

    <span class="keyword">for</span> i = 1:tami(2)
       xd(i) = x(n+tami(2)-i);
       edi = edi + b(i)*ztrans(xd(i));
    <span class="keyword">end</span>

    disp(<span class="string">'APLICAMOS TRANSFORMADA Z'</span>)
    edd = subs(edd, ztrans(y(n), n, z), Y(z));
    edi = subs(edi, ztrans(x(n), n, z), X(z));
    pretty(edd)
    disp(<span class="string">'='</span>)
    pretty(edi)
    disp(<span class="string">'SUBSTITUIMOS CONDICIONES INICIALES'</span>)

    <span class="keyword">for</span> j = 1:tami(2)-1
        edi = subs(edi, x(tami(2)-1-j), 0);
    <span class="keyword">end</span>

    <span class="keyword">for</span> j = 1:tam(2)-1
        edd = subs(edd, y(tam(2)-1-j), ciy(j));
    <span class="keyword">end</span>

    pretty(edd)
    disp(<span class="string">'='</span>)
    pretty(edi)

    disp(<span class="string">'SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA'</span>)
    edi = subs(edi, X(z), ztrans(xi));
    pretty(edd)
    disp(<span class="string">'='</span>)
    pretty(edi)

    disp(<span class="string">'DESPEJAMOS Y(z)'</span>)
    edd = collect(edd, Y(z));
    edd = subs(edd, Y(z), Yy);
    eq1 = edd == edi;
    disp(<span class="string">'Y(z)='</span>)
    edd = solve(eq1, Yy);
    pretty(edd)

    disp(<span class="string">'DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(z)'</span>)
    disp(<span class="string">'Y(z)='</span>)
    pretty(partfrac(edd))

    disp(<span class="string">'Aplicamos transformada inversa, as&iacute; la soluci&oacute;n es'</span>)
    disp(<span class="string">'y(n)='</span>)
    y(n) = iztrans(edd);
    pretty(y(n))

    figure(1)
    hFig = figure(1);
    set(hFig, <span class="string">'Position'</span>, [0 0 900 900])
    tiempo = 0:1:n0;
    stem(tiempo, subs(xi, n, tiempo), <span class="string">'b'</span>, <span class="string">'LineWidth'</span>, 2)
    hold <span class="string">on</span>
    stem(tiempo, subs(y(n), n, tiempo), <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2)
    legend(<span class="string">'Entrada x[n]'</span>, <span class="string">'Salida y[n]'</span>, <span class="string">'Location'</span>, <span class="string">'Best'</span>)
    xlabel(<span class="string">'tiempo'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    title(<span class="string">'Soluci&oacute;n del segundo sistema discreto'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    grid <span class="string">on</span>
<span class="keyword">end</span>
<span class="comment">%</span>
</pre>
<pre class="codeoutput">APLICAMOS TRANSFORMADA Z
          2                                            2
Y(z) + 2 z  Y(z) + 3 z y(0) - 2 z y(1) - 3 z Y(z) - 2 z  y(0)

=
4 z X(z) - 4 z x(0) - 3 X(z)

SUBSTITUIMOS CONDICIONES INICIALES
                2                      2
3 z + Y(z) + 2 z  Y(z) - 3 z Y(z) - 2 z

=
4 z X(z) - 3 X(z)

SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA
                2                      2
3 z + Y(z) + 2 z  Y(z) - 3 z Y(z) - 2 z

=
  /    1        \        3
z | ------- + 1 | 4 - ------- - 3
  \ 4 z - 1     /     4 z - 1

DESPEJAMOS Y(z)
Y(z)=
      3      2
   8 z  + 2 z  - 9 z
----------------------
   3       2
8 z  - 14 z  + 7 z - 1

DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(z)
Y(z)=
    1          6           16
--------- + ------- - ----------- + 1
3 (z - 1)   2 z - 1   (4 z - 1) 3

Aplicamos transformada inversa, as&iacute; la soluci&oacute;n es
y(n)=
              / 1 \n
           16 | - |
  / 1 \n      \ 4 /    1
6 | - |  - --------- + -
  \ 2 /        3       3

</pre>
<img vspace="5" hspace="5" src="prac09_03.png" alt=""> <p>Funci&oacute;n para resolver usando Transformada Z</p>
<pre class="codeinput">
<span class="keyword">function</span> z_transform_solution_1(a, b, ciy, xi, n0)
    <span class="comment">% a: coeficientes de las traslaciones de la salida mayor a menor [a_n, ..., a_0]</span>
    <span class="comment">% b: coeficientes de las traslaciones de la entrada mayor a menor [b_m, ..., b_0]</span>
    <span class="comment">% ciy: condiciones iniciales de la salida de mayor a menor [y(n-1), y(0)]</span>
    <span class="comment">% xi: funci&oacute;n de entrada en t&eacute;rminos de la variable simb&oacute;lica n</span>
    <span class="comment">% n0: tiempo final para graficar la soluci&oacute;n y la entrada</span>

    close <span class="string">all</span>;
    tam = size(a);
    tami = size(b);
    syms <span class="string">y(n)</span> <span class="string">n</span> <span class="string">z</span> <span class="string">Y(z)</span> <span class="string">x(n)</span> <span class="string">X(z)</span> <span class="string">Yy</span>;
    syms <span class="string">edd</span> <span class="string">edi</span>;
    edd = 0;
    edi = 0;

    <span class="keyword">for</span> i = 1:tam(2)
       yd(i) = y(n+tam(2)-i);
       edd = edd + a(i)*ztrans(yd(i));
    <span class="keyword">end</span>

    <span class="keyword">for</span> i = 1:tami(2)
       xd(i) = x(n+tami(2)-i);
       edi = edi + b(i)*ztrans(xd(i));
    <span class="keyword">end</span>

    disp(<span class="string">'APLICAMOS TRANSFORMADA Z'</span>)
    edd = subs(edd, ztrans(y(n), n, z), Y(z));
    edi = subs(edi, ztrans(x(n), n, z), X(z));
    pretty(edd)
    disp(<span class="string">'='</span>)
    pretty(edi)
    disp(<span class="string">'SUBSTITUIMOS CONDICIONES INICIALES'</span>)

    <span class="keyword">for</span> j = 1:tami(2)-1
        edi = subs(edi, x(tami(2)-1-j), 0);
    <span class="keyword">end</span>

    <span class="keyword">for</span> j = 1:tam(2)-1
        edd = subs(edd, y(tam(2)-1-j), ciy(j));
    <span class="keyword">end</span>

    pretty(edd)
    disp(<span class="string">'='</span>)
    pretty(edi)

    disp(<span class="string">'SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA'</span>)
    edi = subs(edi, X(z), ztrans(xi));
    pretty(edd)
    disp(<span class="string">'='</span>)
    pretty(edi)

    disp(<span class="string">'DESPEJAMOS Y(z)'</span>)
    edd = collect(edd, Y(z));
    edd = subs(edd, Y(z), Yy);
    eq1 = edd == edi;
    disp(<span class="string">'Y(z)='</span>)
    edd = solve(eq1, Yy);
    pretty(edd)

    disp(<span class="string">'DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(z)'</span>)
    disp(<span class="string">'Y(z)='</span>)
    pretty(partfrac(edd))

    disp(<span class="string">'Aplicamos transformada inversa, as&iacute; la soluci&oacute;n es'</span>)
    disp(<span class="string">'y(n)='</span>)
    y(n) = iztrans(edd);
    pretty(y(n))

    figure(1)
    hFig = figure(1);
    set(hFig, <span class="string">'Position'</span>, [0 0 900 900])
    tiempo = 0:1:n0;
    stem(tiempo, subs(xi, n, tiempo), <span class="string">'b'</span>, <span class="string">'LineWidth'</span>, 2)
    hold <span class="string">on</span>
    stem(tiempo, subs(y(n), n, tiempo), <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2)
    legend(<span class="string">'Entrada x[n]'</span>, <span class="string">'Salida y[n]'</span>, <span class="string">'Location'</span>, <span class="string">'Best'</span>)
    xlabel(<span class="string">'tiempo'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    title(<span class="string">'Soluci&oacute;n del primer sistema discreto'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    grid <span class="string">on</span>
<span class="keyword">end</span>
<span class="comment">%</span>
</pre>
<pre class="codeoutput">APLICAMOS TRANSFORMADA Z
Y(z) - 2 z y(0) + 2 z Y(z)

=
2 X(z)

SUBSTITUIMOS CONDICIONES INICIALES
Y(z) - 6 z + 2 z Y(z)

=
2 X(z)

SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA
Y(z) - 6 z + 2 z Y(z)

=
  2
----- + 2
z - 1

DESPEJAMOS Y(z)
Y(z)=
        2
6 z + ----- + 2
      z - 1
---------------
    2 z + 1

DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(z)
Y(z)=
    2            7
--------- - ----------- + 3
3 (z - 1)   (2 z + 1) 3

Aplicamos transformada inversa, as&iacute; la soluci&oacute;n es
y(n)=
  /   1 \n
7 | - - |
  \   2 /    2
---------- + -
     3       3

</pre>
<p>combined_solution_continuous.m</p>
<pre class="codeinput">
<span class="keyword">function</span> combined_solution_continuous(a, b, ciy, xi, t0)
    <span class="comment">% a: coeficientes de las derivadas de la salida menor a mayor [a_0, ..., a_n]</span>
    <span class="comment">% b: coeficientes de las derivadas de la entrada menor a mayor [b_0, ..., b_m]</span>
    <span class="comment">% ciy: condiciones iniciales de la salida de menor a mayor [y(0), y(0)^(n-1)]</span>
    <span class="comment">% xi: funci&oacute;n de entrada en t&eacute;rminos de la variable simb&oacute;lica t</span>
    <span class="comment">% t0: tiempo final para graficar la soluci&oacute;n</span>

    <span class="comment">% Soluci&oacute;n usando Transformada de Laplace</span>
    disp(<span class="string">'Soluci&oacute;n usando Transformada de Laplace:'</span>)
    [y_laplace, y_tf] = laplace_solution(a, b, ciy, xi);

    <span class="comment">% Graficar resultados de Laplace</span>
    figure;
    tiempo = 0:0.01:t0;
    fplot(y_laplace, [0, t0], <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2)
    hold <span class="string">on</span>
    fplot(y_tf, [0, t0], <span class="string">'g--'</span>, <span class="string">'LineWidth'</span>, 2)
    legend(<span class="string">'Respuesta Total'</span>, <span class="string">'Funci&oacute;n de Transferencia'</span>)
    xlabel(<span class="string">'tiempo'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    title(<span class="string">'Respuesta del sistema usando Laplace'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    grid <span class="string">on</span>

    <span class="comment">% Soluci&oacute;n usando Transformada de Fourier</span>
    disp(<span class="string">'Soluci&oacute;n usando Transformada de Fourier:'</span>)
    y_fourier = fourier_solution(a, b, xi, t0);

    <span class="comment">% Graficar resultados de Fourier</span>
    figure;
    fplot(xi, [0, t0], <span class="string">'b'</span>, <span class="string">'LineWidth'</span>, 2)
    hold <span class="string">on</span>
    fplot(y_fourier, [0, t0], <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2)
    legend(<span class="string">'Entrada x(t)'</span>, <span class="string">'Salida y(t)'</span>, <span class="string">'Location'</span>, <span class="string">'Best'</span>)
    xlabel(<span class="string">'tiempo'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    title(<span class="string">'Entrada y Respuesta del sistema usando Fourier'</span>, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="string">'FontSize'</span>, 16)
    grid <span class="string">on</span>
<span class="keyword">end</span>

<span class="keyword">function</span> [y_laplace, y_tf] = laplace_solution(a, b, ciy, xi)
    tam = size(a);
    tami = size(b);
    syms <span class="string">y(t)</span> <span class="string">Y(s)</span> <span class="string">x(t)</span> <span class="string">X(s)</span> <span class="string">Yy</span>;
    edd = 0;
    edi = 0;

    <span class="keyword">for</span> i = 1:tam(2)
       edd = edd + a(i)*s^(i-1)*Y(s);
       <span class="keyword">for</span> k = 1:i-1
           edd = edd - a(i)*(s^(i-1-k)*ciy(k));
       <span class="keyword">end</span>
    <span class="keyword">end</span>

    <span class="keyword">for</span> i = 1:tami(2)
       edi = edi + b(i)*s^(i-1)*X(s);
    <span class="keyword">end</span>

    <span class="comment">% Soluci&oacute;n para la respuesta total</span>
    edi = subs(edi, X(s), laplace(xi));
    eq1 = collect(edd == edi, Y(s));
    Y_sol = solve(eq1, Y(s));
    y_laplace = ilaplace(Y_sol);

    <span class="comment">% Soluci&oacute;n para la funci&oacute;n de transferencia</span>
    edi_tf = subs(edi, X(s), 1);
    eq2 = collect(edd == edi_tf, Y(s));
    Y_tf = solve(eq2, Y(s));
    y_tf = ilaplace(Y_tf);
<span class="keyword">end</span>

<span class="keyword">function</span> y_fourier = fourier_solution(a, b, xi, t0)
    tam = size(a);
    tami = size(b);
    syms <span class="string">y(t)</span> <span class="string">Y(w)</span> <span class="string">x(t)</span> <span class="string">X(w)</span> <span class="string">Yy</span>;
    edd = 0;
    edi = 0;

    <span class="keyword">for</span> i = 1:tam(2)
       edd = edd + a(i)*(1i*w)^(i-1)*Y(w);
    <span class="keyword">end</span>

    <span class="keyword">for</span> i = 1:tami(2)
       edi = edi + b(i)*(1i*w)^(i-1)*X(w);
    <span class="keyword">end</span>

    edi = subs(edi, X(w), fourier(xi));
    eq1 = collect(edd == edi, Y(w));
    Y_sol = solve(eq1, Y(w));
    y_fourier = ifourier(Y_sol, t);
<span class="keyword">end</span>
<span class="comment">%</span>
</pre>
<pre class="codeoutput">Soluci&oacute;n usando Transformada de Laplace:
Warning: Unable to find explicit solution. For options, see &lt;a href="matlab:web(fullfile(docroot, 'symbolic/troubleshoot-equation-solutions-from-solve-function.html'))"&gt;help&lt;/a&gt;. 
Warning: Unable to find explicit solution. For options, see &lt;a href="matlab:web(fullfile(docroot, 'symbolic/troubleshoot-equation-solutions-from-solve-function.html'))"&gt;help&lt;/a&gt;. 
Warning: Ignoring extra legend entries. 
Soluci&oacute;n usando Transformada de Fourier:
Warning: Unable to find explicit solution. For options, see &lt;a href="matlab:web(fullfile(docroot, 'symbolic/troubleshoot-equation-solutions-from-solve-function.html'))"&gt;help&lt;/a&gt;. 
Warning: Ignoring extra legend entries. 
</pre>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Práctica 9:  Sistemas diferenciales y en diferencias
%
%% Integrantes: 
%
% Decena Luna Emiliano Abdala
%
% Morales Rodríguez Francisco Jesús
% 
% Soriano López Aron
%
%% Introduccion
%
%%
% ¿Qué es la transformada de Fourier y para que sirve?
% En pocas palabras la transformada de Fourier 
% convierte una función del tiempo, una variable continua, en una función
% de frecuencia, revelando la frecuencia o las frecuencias que componen la señal original.
%
%% Objetivos 
% 
%% 
% Generar un codigo en Matlab que sea capaz de resolver ecuaciones
% diferenciales utilizando la transformada de Fourier para tiempos
% continuos y discretos. 
% Para que asu vez entregar un documento en HTML qeu cumpla los
% requerimientos ya establecidos en la descripcion de Teams. 
%
%% Porcedimiento

%%
% main_script.m

% Ejemplo de uso para la ecuación diferencial especificada
syms t
a = [1 3 3];
b = [-1 1];
ciy = [1, 1];
xi = cos(2*t)*heaviside(t);
t0 = 10;
combined_solution_continuous(a, b, ciy, xi, t0)
%
%%
% Ejemplo de uso para el primer problema discreto
syms n
a = [2 1];
b = [2];
ciy = [3];
xi = heaviside(n);
n0 = 5;
z_transform_solution_1(a, b, ciy, xi, n0)
%
%%
% Ejemplo de uso para el segundo problema discreto
syms n
a2 = [2 -3 1];
b2 = [4 -3];
ciy2 = [0 1];
xi2 = (1/4)^n * heaviside(n);
n0_2 = 5;
z_transform_solution_2(a2, b2, ciy2, xi2, n0_2)
%
%%
function z_transform_solution_2(a, b, ciy, xi, n0)
    % a: coeficientes de las traslaciones de la salida mayor a menor [a_n, ..., a_0]
    % b: coeficientes de las traslaciones de la entrada mayor a menor [b_m, ..., b_0]
    % ciy: condiciones iniciales de la salida de mayor a menor [y(n-1), y(0)]
    % xi: función de entrada en términos de la variable simbólica n
    % n0: tiempo final para graficar la solución y la entrada
    
    close all;
    tam = size(a);
    tami = size(b);
    syms y(n) n z Y(z) x(n) X(z) Yy;
    syms edd edi;
    edd = 0;
    edi = 0;

    for i = 1:tam(2)
       yd(i) = y(n+tam(2)-i);
       edd = edd + a(i)*ztrans(yd(i));
    end

    for i = 1:tami(2)
       xd(i) = x(n+tami(2)-i);
       edi = edi + b(i)*ztrans(xd(i));
    end

    disp('APLICAMOS TRANSFORMADA Z')
    edd = subs(edd, ztrans(y(n), n, z), Y(z));
    edi = subs(edi, ztrans(x(n), n, z), X(z));
    pretty(edd)
    disp('=')
    pretty(edi)
    disp('SUBSTITUIMOS CONDICIONES INICIALES')

    for j = 1:tami(2)-1
        edi = subs(edi, x(tami(2)-1-j), 0);
    end

    for j = 1:tam(2)-1
        edd = subs(edd, y(tam(2)-1-j), ciy(j));
    end

    pretty(edd)
    disp('=')
    pretty(edi)

    disp('SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA')
    edi = subs(edi, X(z), ztrans(xi));
    pretty(edd)
    disp('=')
    pretty(edi)

    disp('DESPEJAMOS Y(z)')
    edd = collect(edd, Y(z));
    edd = subs(edd, Y(z), Yy);
    eq1 = edd == edi;
    disp('Y(z)=')
    edd = solve(eq1, Yy);
    pretty(edd)

    disp('DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(z)')
    disp('Y(z)=')
    pretty(partfrac(edd))

    disp('Aplicamos transformada inversa, así la solución es')
    disp('y(n)=')
    y(n) = iztrans(edd);
    pretty(y(n))

    figure(1)
    hFig = figure(1);
    set(hFig, 'Position', [0 0 900 900])
    tiempo = 0:1:n0;
    stem(tiempo, subs(xi, n, tiempo), 'b', 'LineWidth', 2)
    hold on
    stem(tiempo, subs(y(n), n, tiempo), 'r', 'LineWidth', 2)
    legend('Entrada x[n]', 'Salida y[n]', 'Location', 'Best')
    xlabel('tiempo', 'FontWeight', 'bold', 'FontSize', 16)
    title('Solución del segundo sistema discreto', 'FontWeight', 'bold', 'FontSize', 16)
    grid on
end
%
%%
% Función para resolver usando Transformada Z
function z_transform_solution_1(a, b, ciy, xi, n0)
    % a: coeficientes de las traslaciones de la salida mayor a menor [a_n, ..., a_0]
    % b: coeficientes de las traslaciones de la entrada mayor a menor [b_m, ..., b_0]
    % ciy: condiciones iniciales de la salida de mayor a menor [y(n-1), y(0)]
    % xi: función de entrada en términos de la variable simbólica n
    % n0: tiempo final para graficar la solución y la entrada
    
    close all;
    tam = size(a);
    tami = size(b);
    syms y(n) n z Y(z) x(n) X(z) Yy;
    syms edd edi;
    edd = 0;
    edi = 0;

    for i = 1:tam(2)
       yd(i) = y(n+tam(2)-i);
       edd = edd + a(i)*ztrans(yd(i));
    end

    for i = 1:tami(2)
       xd(i) = x(n+tami(2)-i);
       edi = edi + b(i)*ztrans(xd(i));
    end

    disp('APLICAMOS TRANSFORMADA Z')
    edd = subs(edd, ztrans(y(n), n, z), Y(z));
    edi = subs(edi, ztrans(x(n), n, z), X(z));
    pretty(edd)
    disp('=')
    pretty(edi)
    disp('SUBSTITUIMOS CONDICIONES INICIALES')

    for j = 1:tami(2)-1
        edi = subs(edi, x(tami(2)-1-j), 0);
    end

    for j = 1:tam(2)-1
        edd = subs(edd, y(tam(2)-1-j), ciy(j));
    end

    pretty(edd)
    disp('=')
    pretty(edi)

    disp('SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA')
    edi = subs(edi, X(z), ztrans(xi));
    pretty(edd)
    disp('=')
    pretty(edi)

    disp('DESPEJAMOS Y(z)')
    edd = collect(edd, Y(z));
    edd = subs(edd, Y(z), Yy);
    eq1 = edd == edi;
    disp('Y(z)=')
    edd = solve(eq1, Yy);
    pretty(edd)

    disp('DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(z)')
    disp('Y(z)=')
    pretty(partfrac(edd))

    disp('Aplicamos transformada inversa, así la solución es')
    disp('y(n)=')
    y(n) = iztrans(edd);
    pretty(y(n))

    figure(1)
    hFig = figure(1);
    set(hFig, 'Position', [0 0 900 900])
    tiempo = 0:1:n0;
    stem(tiempo, subs(xi, n, tiempo), 'b', 'LineWidth', 2)
    hold on
    stem(tiempo, subs(y(n), n, tiempo), 'r', 'LineWidth', 2)
    legend('Entrada x[n]', 'Salida y[n]', 'Location', 'Best')
    xlabel('tiempo', 'FontWeight', 'bold', 'FontSize', 16)
    title('Solución del primer sistema discreto', 'FontWeight', 'bold', 'FontSize', 16)
    grid on
end
%
%%
% combined_solution_continuous.m

function combined_solution_continuous(a, b, ciy, xi, t0)
    % a: coeficientes de las derivadas de la salida menor a mayor [a_0, ..., a_n]
    % b: coeficientes de las derivadas de la entrada menor a mayor [b_0, ..., b_m]
    % ciy: condiciones iniciales de la salida de menor a mayor [y(0), y(0)^(n-1)]
    % xi: función de entrada en términos de la variable simbólica t
    % t0: tiempo final para graficar la solución
    
    % Solución usando Transformada de Laplace
    disp('Solución usando Transformada de Laplace:')
    [y_laplace, y_tf] = laplace_solution(a, b, ciy, xi);

    % Graficar resultados de Laplace
    figure;
    tiempo = 0:0.01:t0;
    fplot(y_laplace, [0, t0], 'r', 'LineWidth', 2)
    hold on
    fplot(y_tf, [0, t0], 'gREPLACE_WITH_DASH_DASH', 'LineWidth', 2)
    legend('Respuesta Total', 'Función de Transferencia')
    xlabel('tiempo', 'FontWeight', 'bold', 'FontSize', 16)
    title('Respuesta del sistema usando Laplace', 'FontWeight', 'bold', 'FontSize', 16)
    grid on

    % Solución usando Transformada de Fourier
    disp('Solución usando Transformada de Fourier:')
    y_fourier = fourier_solution(a, b, xi, t0);

    % Graficar resultados de Fourier
    figure;
    fplot(xi, [0, t0], 'b', 'LineWidth', 2)
    hold on
    fplot(y_fourier, [0, t0], 'r', 'LineWidth', 2)
    legend('Entrada x(t)', 'Salida y(t)', 'Location', 'Best')
    xlabel('tiempo', 'FontWeight', 'bold', 'FontSize', 16)
    title('Entrada y Respuesta del sistema usando Fourier', 'FontWeight', 'bold', 'FontSize', 16)
    grid on
end

function [y_laplace, y_tf] = laplace_solution(a, b, ciy, xi)
    tam = size(a);
    tami = size(b);
    syms y(t) Y(s) x(t) X(s) Yy;
    edd = 0;
    edi = 0;

    for i = 1:tam(2)
       edd = edd + a(i)*s^(i-1)*Y(s);
       for k = 1:i-1
           edd = edd - a(i)*(s^(i-1-k)*ciy(k));
       end
    end

    for i = 1:tami(2)
       edi = edi + b(i)*s^(i-1)*X(s);
    end

    % Solución para la respuesta total
    edi = subs(edi, X(s), laplace(xi));
    eq1 = collect(edd == edi, Y(s));
    Y_sol = solve(eq1, Y(s));
    y_laplace = ilaplace(Y_sol);
    
    % Solución para la función de transferencia
    edi_tf = subs(edi, X(s), 1);
    eq2 = collect(edd == edi_tf, Y(s));
    Y_tf = solve(eq2, Y(s));
    y_tf = ilaplace(Y_tf);
end

function y_fourier = fourier_solution(a, b, xi, t0)
    tam = size(a);
    tami = size(b);
    syms y(t) Y(w) x(t) X(w) Yy;
    edd = 0;
    edi = 0;

    for i = 1:tam(2)
       edd = edd + a(i)*(1i*w)^(i-1)*Y(w);
    end

    for i = 1:tami(2)
       edi = edi + b(i)*(1i*w)^(i-1)*X(w);
    end

    edi = subs(edi, X(w), fourier(xi));
    eq1 = collect(edd == edi, Y(w));
    Y_sol = solve(eq1, Y(w));
    y_fourier = ifourier(Y_sol, t);
end
%
##### SOURCE END #####
-->
</body>
</html>
